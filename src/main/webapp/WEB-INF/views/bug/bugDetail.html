<@g.head "漏洞详细">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/bug/bugDetail.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/wangEditor/wangEditor.min.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/wangEditor/dark.css">
    <script type="text/javascript" src="${ctx}/static/script/wangEditor/wangEditor.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/wangEditor/highlight.pack.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/xss/xss.min.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/html-docx/FileSaver.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/html-docx/html-docx.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/constant.js" ></script>
</@g.head>
<body>
<@g.nav "bug" />
<div class="container box">
	<!-- 隐藏input,用于存储漏洞id -->
	<input id="leakId" type=hidden value=${leakVo.id}>
    <ol class="breadcrumb" style="border-radius: 0px;margin: 0px">
        <label>当前路径:</label>
        <li>漏洞</li>
        <li>漏洞详细</li>
    </ol>
    <div class="row" style="padding: 15px">
        <div class="col-xs-12" style="margin: 20px 0px">
			<div class="row" id="">
			
			<!-- 判断用户权限后显示 start-->
			<div class="col-xs-12 text-right" style="margin-bottom:10px">
			 	<#if leakVo.canUpdate>
                  	<button class="btn btn-default" onclick="updateBug(${leakVo.id})">修改</button>
                </#if>
                
                <#if leakVo.notice>
                  	 <button class="btn btn-info" onclick="getDoc(${leakVo.id})">生成通知单</button>
                </#if>
                
                <#if leakVo.audit>
                  	 <button class="btn btn-primary" data-toggle="modal" data-target="#reviewModal">我来审核</button> 
                </#if>
			</div>
			<!-- 判断用户权限后显示 end-->

				<div id="test">
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>基础信息</a></h4>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>漏洞编号:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.leakNo}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>CVE－ID:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.cveId}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>漏洞标题:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.leakName}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>CNNVD－ID:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.cnnvdId}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>涉及的信息系统名称:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.influenceSystemName}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>CNVD－ID:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.cnvdId}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>漏洞类型:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.leakTypeName}</div>
				        </div>
				        <div class="col-xs-6 col-xs-offset-6"></div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>危害等级:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.riskLevelName}</div>
				        </div>
				        <div class="col-xs-6 col-xs-offset-6"></div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>发布人:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.submitUserAccount}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>发布时间:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.submitTime}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>审核人:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.auditUserAccount}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>审核时间:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.auditTime}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>审核结果:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.auditResult}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>漏洞作者:</label>
				            </div>
				            <div class="col-xs-7">${leakVo.leakAuthor}</div>
				        </div>
				        <div class="col-xs-6 contentList">
				            <div class="col-xs-5 text-right clean">
				                <label>附件:</label>
							</div>
				            	<#if leakVo.attachmentDownLoadPath??>
									<div class="col-xs-7">
										<a href="${leakVo.attachmentDownLoadPath}"><i class="glyphicon glyphicon-download-alt"></i></a>
									</div>
								<#else>
									<div class="col-xs-7">
										<span>没有附件</span>
									</div>
								</#if>
				        </div>
				    </div>
				</div>
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>概要描述</a></h4>
				        </div>
				        <div class="col-xs-12 editor"><p>${leakVo.leakOutline}</p></div>
				    </div>
				</div>
				<div class="col-xs-12" id="detail">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>漏洞详情</a></h4>
				        </div>
				        <div class="col-xs-12 editor" id="docHtml">${leakVo.leakDetail}</div>
				    </div>
				</div>
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>修复方案</a></h4>
				        </div>
				        <div class="col-xs-12 editor">${leakVo.solution}</div>
				    </div>
				</div>
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>审核意见</a></h4>
				        </div>
				        <div class="col-xs-12 editor">${leakVo.auditOpinion}</div>
				    </div>
				</div>
				</div>
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText" style="margin-bottom:0px">
				            <h4><a>评论</a></h4>
				        </div>
				        <div class="col-xs-12 editor">
				            <div class="row class">
				                <table id="comment_table" class="table table-striped table-bordered" ></table>
				            </div>
				
				        </div>
				    </div>
				</div>
				<div class="col-xs-12">
				    <div class="row infoDiv">
				        <div class="col-xs-12 titleText">
				            <h4><a>我来评论</a></h4>
				        </div>
				        <div class="col-xs-12">
				            <div id="myComment" style="height: 300px"></div>
				        </div>
				        <div class="col-xs-12 text-right" style="margin-top: 10px">
				            <button class="btn btn-primary" id = "submitComment">提交评论</button>
				        </div>
				    </div>
				</div>
				<div class="modal fade" id="reviewModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
				    <div class="modal-dialog" role="document">
				        <div class="modal-content">
				            <div class="modal-header">
				                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				                <h4 class="modal-title" id="modalLabel">漏洞审核</h4>
				            </div>
				            <form id="auditForm">
				                <input type="hidden" id="bugId" name="id" value="${leakVo.id}">
				                <div class="modal-body">
				                    <div class="row">
				                        <div class="col-xs-12 form-group">
				                            <label for="result">审核结果:</label>
				                            <select class="selectpicker show-tick form-control" id="result" name="auditResult">
				                                <option>请选择</option>
				                                <option value="1">误报</option>
				                                <option value="2">重复</option>
				                                <option value="3">漏洞</option>
				                                <option value="4">省公司首发漏洞</option>
				                                <option value="5">国网首发漏洞</option>
				                            </select>
				                        </div>
				                        <div class="col-xs-12 form-group" id="review_status">
				                            <label for="reviewText">审核意见:</label>
				                            <textarea class="form-control" id="reviewText" name="auditOpinion" style="width:100%;height: 200px;overflow-x: hidden;resize: none;" placeholder="请输入审核意见,不能为空"></textarea>
				                        </div>
				                    </div>
				                </div>
				                <div class="modal-footer">
				                    <button type="reset" class="btn btn-default">重置</button>
<!-- 				                    <button type="button" class="btn btn-primary" id="reviewSubmit" onclick="setTable(${leakVo.id})">提交</button> -->
				                    <button type="button" class="btn btn-primary" id="reviewSubmit" >提交</button>
				                </div>
				            </form>
				        </div>
				    </div>
				</div>
            </div>
        </div>
    </div>
</div>
<@g.footer />
</body>
<script type="text/javascript" src="${ctx}/static/script/bug/bugDetail.js"></script>
</html>