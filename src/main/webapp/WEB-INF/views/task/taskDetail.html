<@g.head "任务详细">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/bug/bugDetail.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/bootstrap/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/wangEditor/wangEditor.min.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/wangEditor/dark.css">
    <link rel="stylesheet" type="text/css" href="${ctx}/static/css/bootstrap/bootstrap-fileinput.min.css">
    <script type="text/javascript" src="${ctx}/static/script/wangEditor/wangEditor.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/wangEditor/highlight.pack.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/xss/xss.min.js" ></script>
    <script type="text/javascript" src="${ctx}/static/script/bootstrap/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="${ctx}/static/script/bootstrap/defaults-zh_CN.min.js"></script>
    <script type="text/javascript" src="${ctx}/static/script/bootstrap/fileinput/fileinput.min.js"></script>
    <script type="text/javascript" src="${ctx}/static/script/bootstrap/fileinput/zh.js"></script>
    <script type="text/javascript" src="${ctx}/static/script/constant.js" ></script>
</@g.head>
<body>
<@g.nav "task" />
<div class="container box">
    <ol class="breadcrumb" style="border-radius: 0px;margin: 0px">
        <label>当前路径:</label>
        <li>任务</li>
        <li>任务详细</li>
    </ol>
    <div class="row" style="padding: 15px">
        <div class="col-xs-12" style="margin: 20px 0px">
            <div class="row">
            	<input type="hidden" id="tmpTaskId" name="taskId" value="${task.taskId}"/>
                <div class="col-xs-12 text-right" style="margin-bottom:10px">
                	<#if task.mark>
                		<button class="btn btn-primary" id="mark" data-toggle="modal" data-target="#markModel" >分配积分</button>
                   	</#if>
                    <#if task.receive>
                    	<button class="btn btn-primary" id="acceptButton" >接受任务</button>
                    </#if>
                    <#if task.submit>
                   		<button class="btn btn-default" id="submitButton">提交成果</button>
                    </#if>
                    <#if task.leader>
                   		<button class="btn btn-info" id="changeButton">转移队长</button>
                    </#if>
                    <#if task.receiveLeader>
                   		<button class="btn btn-info" id="receiveLeaderButton">接受队长</button>
                   		<button class="btn btn-info" id="refuseLeaderButton">拒绝接受</button>
                    </#if>
                    <#if task.release>
                    	<button class="btn btn-primary" id="releaseButton">发布任务</button>
                    	<button class="btn btn-info" id="updateButton">修改任务</button>
	                    <button class="btn btn-danger" id="deleteButton">删除任务</button>
                    </#if>
                    <#if task.submitOrCancel>
                    	<button class="btn btn-success" id="completeButton">确认完成任务</button>
                    	<button class="btn btn-warning" id="cancelButton">取消任务</button>
                    </#if>
                </div>
                <div class="col-xs-12">
                    <div class="row infoDiv">
                        <div class="col-xs-12 titleText">
                            <h4><a>基础信息</a></h4>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>任务名称:</label>
                            </div>
                            <div class="col-xs-7">${task.taskName}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>任务积分:</label>
                            </div>
                            <div class="col-xs-7">${task.taskScore}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>任务类型:</label>
                            </div>
                            <div class="col-xs-7">${task.taskTypeName}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>任务状态:</label>
                            </div>
                            <div class="col-xs-7">${task.taskStatus}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>发布人:</label>
                            </div>
                            <div class="col-xs-7"><a href="${ctx}/toUserInfo?userID=${task.releaseUserId}">${task.releaseUserAccount}</a></div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>队长:</label>
                            </div>
                            <div class="col-xs-7"><a href="${ctx}/toUserInfo?userID=${task.leaderUserId}">${task.leaderUserAccount}</a></div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>发布时间:</label>
                            </div>
                            <div class="col-xs-7">${task.releaseTime}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>参与队员:</label>
                            </div>
                            <div class="col-xs-7">
                            	<#list task.memberUser as user>
	                                <a href="${ctx}/toUserInfo?userID=${user.id}">${user.userAccount}</a>
                            	</#list>
                            </div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>限定人数:</label>
                            </div>
                            <div class="col-xs-7">${task.taskNum}</div>
                        </div>
                        <div class="col-xs-6 contentList">
                            <div class="col-xs-5 text-right clean">
                                <label>截止时间:</label>
                            </div>
                            <div class="col-xs-7">${task.taskEndTime}</div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12">
                    <div class="row infoDiv">
                        <div class="col-xs-12 titleText">
                            <h4><a>任务简介</a></h4>
                        </div>
                        <div class="col-xs-12 editor">
                        	${task.taskOutline}
                        </div>
                    </div>
                </div>
                <div class="col-xs-12">
                    <div class="row infoDiv">
                        <div class="col-xs-12 titleText">
                            <h4><a>任务要求</a></h4>
                        </div>
                        <div class="col-xs-12 editor">
                        	${task.taskRequirement}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <#if task.submit>
    <div class="modal fade" id="submitTaskModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提交任务成果</h4>
                </div>
                <form id="submitTaskForm">
                	<input type="hidden" id="attachmentId" name="attachmentId"/>
                	<input type="hidden" id="taskId" name="taskId" value="${task.taskId}"/>
                    <div class="modal-body">
                        <div class="form-group">
                            <input id="taskFile" type="file" name="multipartFile">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="submitResult">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </#if>
    <#if task.leader>
    <div class="modal fade" id="transCaptionModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">转移队长</h4>
                </div>
                <form id="changeLeaderForm">
                	<input type="hidden" name="leaderTaskId" value="${task.taskId}"/>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="newCaption">选择队长:</label>
                            <select class="form-control show-tick show-menu-arrow" id="newCaption" name="leaderUserId"></select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="submitLeader">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </#if>
    <div class="modal fade" id="markModel" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">分配积分</h4>
                </div>
                <form id="markForm">
                	<input type="hidden" name="taskId" value="${task.taskId}"/>
                	<input type="hidden" name="taskScore" value="${task.taskScore}"/>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="row userList">
                            	<div class="col-xs-12">
                            		<div class="col-xs-3 text-right">总积分:</div>
	                            	<div class="col-xs-9 text-left" >${task.taskScore}</div>
                            	</div>
                            	<#if task.leaderUserAccount??>
	                            	<div class="col-xs-12">
		                            	<div class="col-xs-3 text-right">${task.leaderUserAccount}:</div>
		                            	<input type="hidden" name="userId" value="${task.leaderUserId}"/>
		                            	<div class="col-xs-9 text-left"><input type="text" name="score" class="form-control userMark"></div>
	                            	</div>
                            	</#if>
                            	<#list task.memberUser as user>
	                            	<div class="col-xs-12">
		                                <div class="col-xs-3 text-right">${user.userAccount}:</div>
		                                <input type="hidden" name="userId" value="${user.id}"/>
		                                <div class="col-xs-9 text-left"><input type="text" name="score" class="form-control userMark"></div>
	                                <div class="col-xs-12">
                            	</#list>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="setMark(${task.taskScore})">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<@g.footer />
</body>
<script type="text/javascript" src="${ctx}/static/script/task/taskDetail.js"></script>
</html>