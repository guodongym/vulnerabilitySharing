package com.starsec.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.starsec.dao.LeakCommentDao;
import com.starsec.dao.LeakDao;
import com.starsec.model.DataTablePage;
import com.starsec.model.Result;
import com.starsec.po.Leak;
import com.starsec.po.LeakComment;
import com.starsec.util.DateUtil;
import com.starsec.util.SessionUtil;

/**
 * 漏洞
 * @author cheng cheng
 *
 */
@Service
public class LeakCommentService{
	
	
	//漏洞评论
	@Autowired
	private LeakCommentDao leakCommentDao;
	
	//漏洞
	@Autowired
	private LeakDao leakDao;
	
	
	
	/**
	 * 漏洞所属评论
	 * @param page
	 * @param leakId
	 * @return
	 */
	public DataTablePage findPageByLeakId(DataTablePage page, Integer leakId) {
		page.resetPageNo();
		return leakCommentDao.findPageByLeakId(page,leakId);
	}


	/**
	 * 新增评论
	 * @param content
	 * @param leakId
	 * @return
	 */
	public Result save(String content, Integer leakId) {
		Leak leak = leakDao.get(leakId);
		LeakComment leakComment = new LeakComment();
		leakComment.setLeak(leak);
		leakComment.setCommentUser(SessionUtil.loginUser());
		leakComment.setCommentTime(DateUtil.currentTime());
		leakComment.setContent(content);
		leakCommentDao.save(leakComment);
		return Result.SUCCESS;
	}


	
	
	
	
}