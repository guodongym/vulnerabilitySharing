package com.starsec.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.starsec.constants.Constants;
import com.starsec.dao.SysMessageDao;
import com.starsec.model.DataTablePage;
import com.starsec.model.Result;
import com.starsec.po.SysMessage;
import com.starsec.util.SessionUtil;

@Service
public class SysMessageService {

	@Autowired
	private SysMessageDao sysMessageDao;

	
	public DataTablePage findPage(DataTablePage page,boolean isRead) {
		page.resetPageNo();
		return sysMessageDao.findPage(page,isRead);
	}

	
	public Long countNotRead(){
		return sysMessageDao.countNotRead();
	}

	public Result updateRead(Integer messageId) {
		SysMessage sysMessage = sysMessageDao.get(messageId);
		sysMessage.setRead(true);
		
		sysMessageDao.update(sysMessage);
		SessionUtil.getSession().setAttribute(Constants.NEWS_NUM, sysMessageDao.countNotRead().intValue());
		return Result.SUCCESS;
	}
}