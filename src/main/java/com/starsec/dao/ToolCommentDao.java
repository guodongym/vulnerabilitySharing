package com.starsec.dao;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

import org.hibernate.Query;
import org.springframework.stereotype.Repository;

import com.starsec.model.DataTablePage;
import com.starsec.po.ToolComment;
import com.starsec.vo.ToolCommentVo;

/** 工具评论表(TOOL_COMMENT) **/
@Repository
public class ToolCommentDao extends BaseDao<ToolComment, Serializable> {

	/**
	 * 找到工具的评论
	 * @param toolId
	 * @return
	 */
	public List<ToolComment> findsoolCommentsByToolId(Integer toolId) {
		String hql =" from "+ToolComment.class.getCanonicalName()
				+" as toolComment where toolComment.tool.id = :toolId " ;
		Query query = this.getSession().createQuery(hql);
		query.setParameter("toolId", toolId);
		@SuppressWarnings("unchecked")
		List<ToolComment> toolComments = query.list();
		return toolComments;
	}

	public DataTablePage findPageByToolId(DataTablePage page, Integer toolId) {
		StringBuffer hql = new StringBuffer(" from " + ToolComment.class.getCanonicalName() + " where 1=1");
		List<Object> paramList = new ArrayList<Object>();
		
		hql.append(" and tool.id = ? ");
		paramList.add(toolId);
		
		hql.append(" order by commentTime desc ");

		return super.findPageByFetchedHql(ToolCommentVo.class, hql.toString(), null, page.getPageNo(), page.getLimit(), paramList.toArray());

	}
}