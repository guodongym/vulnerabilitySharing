package com.starsec.po;

import java.io.Serializable;
import java.util.Date;
import java.util.HashSet;
import java.util.Set;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.OneToMany;
import javax.persistence.OneToOne;

import org.hibernate.annotations.GenericGenerator;

/** 漏洞表(LEAK) **/
@Entity(name = "LEAK")
public class Leak implements Serializable {

	private static final long serialVersionUID = 1L;

	/** 漏洞ID (Not Null) */
	@Id
	@GeneratedValue(generator = "LeakGenerator")
	@GenericGenerator(name = "LeakGenerator", strategy = "native")
	@Column(name = "leak_id")
	private Integer id;
	/** 漏洞编号，根据规则自动生成 (Not Null) */
	@Column(name = "leak_no")
	private String leakNo;
	/** 漏洞名称 (Not Null) */
	@Column(name = "leak_name")
	private String leakName;
	/** 涉及系统名称 (Not Null) */
	@Column(name = "influence_system_name")
	private String influenceSystemName;
	/** 漏洞状态 1：未发布 2：未审核 3：已审核 4:已删除   (Not Null) */
	@Column(name = "leak_status")
	private Integer leakStatus;
	/** 提交时间 (Not Null) */
	@Column(name = "submit_time")
	private Date submitTime;
	/** 漏洞类型ID (Not Null) */
	@ManyToOne(fetch = FetchType.EAGER)
	@JoinColumn(name = "leak_type_id")
	private LeakType leakType;
	/** 提交人用户ID */
	@ManyToOne(fetch = FetchType.EAGER)
	@JoinColumn(name = "submit_user_id")
	private SysUser submitUser;
	/** 审核人用户ID */
	@ManyToOne(fetch = FetchType.EAGER)
	@JoinColumn(name = "audit_user_id")
	private SysUser auditUser;
	/** 附件ID */
	@OneToOne(fetch = FetchType.EAGER)
	@JoinColumn(name = "attachment_id")
	private SysAttachment sysAttachment;
	/** 危险等级 1：高 2：中 3：低 (Not Null) */
	@Column(name = "risk_level")
	private Integer riskLevel;
	/** 漏洞作者 */
	@Column(name = "leak_author")
	private String leakAuthor;
	/** 漏洞概要 (Not Null) */
	@Column(name = "leak_outline")
	private String leakOutline;
	/** CVE-ID */
	@Column(name = "CVE_ID")
	private String cveId;
	/** CNNVD-ID */
	@Column(name = "CNNVD_ID")
	private String cnnvdId;
	/** CNVD-ID */
	@Column(name = "CNVD_ID")
	private String cnvdId;
	/** 审核时间 */
	@Column(name = "audit_time")
	private Date auditTime;
	/** 审核结果 1：误报 2：重复 3：省公司首发漏洞 4：国网首发漏洞 */
	@Column(name = "audit_result")
	private Integer auditResult;
	/** 审核意见 */
	@Column(name = "audit_opinion")
	private String auditOpinion;
	/** 漏洞详情 (Not Null) */
	@Column(name = "leak_detail")
	private String leakDetail;
	/** 解决方案 */
	@Column(name = "solution")
	private String solution;

	@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "leak")
	private Set<LeakComment> leakComments = new HashSet<LeakComment>();

	public Integer getId() {
		return id;
	}

	public void setId(Integer id) {
		this.id = id;
	}

	public String getLeakNo() {
		return leakNo;
	}

	public void setLeakNo(String leakNo) {
		this.leakNo = leakNo;
	}

	public String getLeakName() {
		return leakName;
	}

	public void setLeakName(String leakName) {
		this.leakName = leakName;
	}

	public String getInfluenceSystemName() {
		return influenceSystemName;
	}

	public void setInfluenceSystemName(String influenceSystemName) {
		this.influenceSystemName = influenceSystemName;
	}

	public Integer getLeakStatus() {
		return leakStatus;
	}

	public void setLeakStatus(Integer leakStatus) {
		this.leakStatus = leakStatus;
	}

	public Date getSubmitTime() {
		return submitTime;
	}

	public void setSubmitTime(Date submitTime) {
		this.submitTime = submitTime;
	}

	public LeakType getLeakType() {
		return leakType;
	}

	public void setLeakType(LeakType leakType) {
		this.leakType = leakType;
	}

	public SysUser getSubmitUser() {
		return submitUser;
	}

	public void setSubmitUser(SysUser submitUser) {
		this.submitUser = submitUser;
	}

	public SysUser getAuditUser() {
		return auditUser;
	}

	public void setAuditUser(SysUser auditUser) {
		this.auditUser = auditUser;
	}

	public SysAttachment getSysAttachment() {
		return sysAttachment;
	}

	public void setSysAttachment(SysAttachment sysAttachment) {
		this.sysAttachment = sysAttachment;
	}

	public Integer getRiskLevel() {
		return riskLevel;
	}

	public void setRiskLevel(Integer riskLevel) {
		this.riskLevel = riskLevel;
	}

	public String getLeakAuthor() {
		return leakAuthor;
	}

	public void setLeakAuthor(String leakAuthor) {
		this.leakAuthor = leakAuthor;
	}

	public String getLeakOutline() {
		return leakOutline;
	}

	public void setLeakOutline(String leakOutline) {
		this.leakOutline = leakOutline;
	}

	public String getCveId() {
		return cveId;
	}

	public void setCveId(String cveId) {
		this.cveId = cveId;
	}

	public String getCnnvdId() {
		return cnnvdId;
	}

	public void setCnnvdId(String cnnvdId) {
		this.cnnvdId = cnnvdId;
	}

	public String getCnvdId() {
		return cnvdId;
	}

	public void setCnvdId(String cnvdId) {
		this.cnvdId = cnvdId;
	}

	public Date getAuditTime() {
		return auditTime;
	}

	public void setAuditTime(Date auditTime) {
		this.auditTime = auditTime;
	}

	public Integer getAuditResult() {
		return auditResult;
	}

	public void setAuditResult(Integer auditResult) {
		this.auditResult = auditResult;
	}

	public String getAuditOpinion() {
		return auditOpinion;
	}

	public void setAuditOpinion(String auditOpinion) {
		this.auditOpinion = auditOpinion;
	}

	public String getLeakDetail() {
		return leakDetail;
	}

	public void setLeakDetail(String leakDetail) {
		this.leakDetail = leakDetail;
	}

	public String getSolution() {
		return solution;
	}

	public void setSolution(String solution) {
		this.solution = solution;
	}

	public Set<LeakComment> getLeakComments() {
		return leakComments;
	}

	public void setLeakComments(Set<LeakComment> leakComments) {
		this.leakComments = leakComments;
	}

}